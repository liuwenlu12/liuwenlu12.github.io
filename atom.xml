<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://liuwenlu12.github.io/</id>
    <title>åˆ˜æ–‡è·¯çš„åšå®¢</title>
    <updated>2020-02-26T18:10:18.831Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://liuwenlu12.github.io/"/>
    <link rel="self" href="https://liuwenlu12.github.io//atom.xml"/>
    <subtitle>ä¸å…¶ä»“çš‡è¿½èµ¶æ—¥è½ï¼Œä¸å¦‚é™å¾…æ¼«å¤©æ˜Ÿè¾°</subtitle>
    <logo>https://liuwenlu12.github.io//images/avatar.png</logo>
    <icon>https://liuwenlu12.github.io//favicon.ico</icon>
    <rights>All rights reserved 2020, åˆ˜æ–‡è·¯çš„åšå®¢</rights>
    <entry>
        <title type="html"><![CDATA[ç¬”è®°]]></title>
        <id>https://liuwenlu12.github.io//post/bi-ji</id>
        <link href="https://liuwenlu12.github.io//post/bi-ji">
        </link>
        <updated>2020-02-26T16:08:30.000Z</updated>
        <content type="html"><![CDATA[<p>Â·Â·Â·<br>
saveAsTable:<br>
1. å¦‚æœè¡¨ä¸å­˜åœ¨, åˆ™ä¼šè‡ªåŠ¨åˆ›å»º<br>
2. å¦‚æœè¡¨å­˜åœ¨(append),  åˆ™åé¢å­˜å‚¨çš„æ•°æ®, å…ƒæ•°æ®çš„é¡ºåºè¦ä¸è¡¨ä¸­çš„å…ƒæ•°æ®çš„é¡ºåºä¸€è‡´<br>
è¡¨å†…æ•°æ®:<br>
a(int)     b(string)<br>
æ–°çš„æ•°æ®:<br>
aa(int)    bb(string)<br>
3. åˆ—åå¯ä»¥ä¸ä¸€è‡´</p>
<p>insertInto<br>
1. è¦æ±‚è¡¨å¿…é¡»å­˜åœ¨<br>
2. è¦æ±‚åˆ—åå¿…é¡»ä¸€è‡´.<br>
è¡¨å†…æ•°æ®:<br>
a(int)  b(String)</p>
<pre><code>    æ–°çš„æ•°æ®:
        b(string)  a(int)
</code></pre>
<p>Â·Â·Â·</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ Sparké›†ç¾¤å¯åŠ¨æµç¨‹åˆ†æ]]></title>
        <id>https://liuwenlu12.github.io//post/spark-ji-qun-qi-dong-liu-cheng-fen-xi</id>
        <link href="https://liuwenlu12.github.io//post/spark-ji-qun-qi-dong-liu-cheng-fen-xi">
        </link>
        <updated>2020-02-26T15:53:46.000Z</updated>
        <content type="html"><![CDATA[<h4 id="æµç¨‹">æµç¨‹</h4>
<figure data-type="image" tabindex="1"><img src="https://liuwenlu12.github.io//post-images/1582732625980.png" alt=""></figure>
<h4 id="masteræœåŠ¡ç«¯å£-7077">MasteræœåŠ¡ç«¯å£ 7077</h4>
<pre><code>   1 val args = new MasterArguments(argStrings, conf)  å°è£…å‚æ•°

  2  val (rpcEnv, _, _) = startRpcEnvAndEndpoint(args.host, args.port, args.webUiPort, conf)   å¯åŠ¨RPCï¼ŒEndpoint

 3 val rpcEnv = RpcEnv.create(SYSTEM_NAME, host, port, conf, securityMgr) åˆ›å»ºrpcEnv

4     new NettyRpcEnvFactory().create(config) //Netty

5    if (!config.clientMode) //é›†ç¾¤æ¨¡å¼ä¸ºtrue

6           Utils.startServiceOnPort(config.port, startNettyRpcEnv, sparkConf, config.name)._1  å¯åŠ¨æœåŠ¡NettyRPCEnv

7           val masterEndpoint = rpcEnv.setupEndpoint(ENDPOINT_NAME,
      new Master(rpcEnv, rpcEnv.address, webUiPort, securityMgr, conf)) å¯åŠ¨Endpoint

8      dispatcher.registerRpcEndpoint(name, endpoint) //æ³¨å†Œåˆ°dispatcher
            æ¶ˆæ¯åˆ†å‘å™¨ æå‡å¼‚æ­¥èƒ½åŠ›
        
---------------------------------------------
private[spark] trait RpcEnvFactory {
 * An end point for the RPC that defines what functions to trigger given a message.
 *
 * It is guaranteed that `onStart`, `receive` and `onStop` will be called in sequence.
 *
 * The life-cycle of an endpoint is:
 *
 * constructor -&gt; onStart -&gt; receive* -&gt; onStop

* Note: `receive` can be called concurrently. If you want `receive` to be thread-safe, please use
 * [[ThreadSafeRpcEndpoint]]
 *
 * If any error is thrown from one of [[RpcEndpoint]] methods except `onError`, `onError` will be
 * invoked with the cause. If `onError` throws an error, [[RpcEnv]] will ignore it.
---------------------------------------------
 9 onstart --&gt;
 checkForWorkerTimeOutTask = forwardMessageThread.scheduleAtFixedRate//å›ºå®šæ£€æŸ¥workeræ˜¯å¦è¶…æ—¶  é»˜è®¤æ¯åˆ†é’Ÿä¸€æ¬¡  è‡ªå·±ç»™è‡ªå·±å‘æ¶ˆæ¯         self.send(CheckForWorkerTimeOut)
 10 receive--&gt;
  override def receive: PartialFunction[Any, Unit] 
     case CheckForWorkerTimeOut =&gt;
      timeOutDeadWorkers()//ç§»é™¤worker
</code></pre>
<h4 id="worker">Worker</h4>
<pre><code> 1 val args = new WorkerArguments(argStrings, conf)  å°è£…å‚æ•°
    
 2 val rpcEnv = startRpcEnvAndEndpoint(args.host, args.port, args.webUiPort, args.cores,
      args.memory, args.masters, args.workDir, conf = conf) å¯åŠ¨RPCï¼ŒEndpoint

  val rpcEnv = RpcEnv.create(systemName, host, port, conf, securityMgr) åˆ›å»ºrpcEnv

 val masterAddresses = masterUrls.map(RpcAddress.fromSparkURL(_))  Msteråœ°å€(æ³¨å†Œç”¨  é«˜å¯ç”¨æœ‰å¤šä¸ª  éƒ½å‘é€) 

 rpcEnv.setupEndpoint(ENDPOINT_NAME, new Worker(rpcEnv, webUiPort, cores, memory,
      masterAddresses, ENDPOINT_NAME, workDir, conf, securityMgr))   setupEndpoint

3 new Worker--&gt;

def assert(assertion: Boolean) {
    if (!assertion)
      throw new java.lang.AssertionError(&quot;assertion failed&quot;)  å·²æ³¨å†ŒæŠ›å¼‚å¸¸
  }

  4  registerWithMaster()  //æ³¨å†Œè‡ªå·±

    registerMasterFutures = tryRegisterAllMasters() //æ‰€æœ‰masteræ³¨å†Œ

     val masterEndpoint = rpcEnv.setupEndpointRef(masterAddress, Master.ENDPOINT_NAME)
     registerWithMaster(masterEndpoint)
        //è·å–ref æ³¨å†Œ

  masterEndpoint.ask[RegisterWorkerResponse] RegisterWorker(
      workerId, host, port, self, cores, memory, workerWebUiUrl))
 //å‘ä¿¡æ¯ å¸Œæœ›Msterå›ä¸€RegisterWorkerResponse  ç»™masterè‡ªå·±æ‰€æœ‰ä¿¡æ¯

  masterç«¯   override def receiveAndReply(context: RpcCallContext): PartialFunction 
     if (state == RecoveryState.STANDBY) {
        context.reply(MasterInStandby)   //è‡ªå·±STANDBY
....å„ç§äº¤äº’
           5   if (registerWorker(worker)) //Masterç»™ä¸æ³¨å†Œ

   workers.filter { w =&gt;
      (w.host == worker.host &amp;&amp; w.port == worker.port) &amp;&amp; (w.state == WorkerState.DEAD)
    }.foreach { w =&gt;
      workers -= w
    }   //æ›¾ç»æ³¨å†Œè¿‡ çŠ¶æ€æ­»  

  context.reply(RegisteredWorker(self, masterWebUiUrl))//å“åº”worker å‘Šè¯‰workeræˆ‘æ˜¯å“ªä¸ªmaster


logInfo(&quot;Successfully registered with master &quot; + masterRef.address.toSparkURL)
      registered = true
     changeMaster(masterRef, masterWebUiUrl) //æ”¹åœ°å€
forwordMessageScheduler.scheduleAtFixedRate //å‘å¿ƒè·³

      if (connected) { sendToMaster(Heartbeat(workerId, self)) }  //å¿ƒè·³
      case Some(masterRef) =&gt; masterRef.send(message)

         workerInfo.lastHeartbeat = System.currentTimeMillis() //Masterç«¯ ä¸€åˆ†é’Ÿè¶…æ—¶  åäº”ç§’å¿ƒè·³

masterå¦‚æœæ²¡èµ·æ¥   ç”¨å®šæ—¶å™¨å°è¯•ç»§ç»­æ³¨å†Œè‡ªå·±  16æ¬¡ï¼ˆ6+10ï¼‰

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Sparké€šè®¯æ¶æ„]]></title>
        <id>https://liuwenlu12.github.io//post/spark-tong-xun-jia-gou</id>
        <link href="https://liuwenlu12.github.io//post/spark-tong-xun-jia-gou">
        </link>
        <updated>2020-02-26T15:18:36.000Z</updated>
        <content type="html"><![CDATA[<h4 id="spark-å†…ç½®-rpc-æ¡†æ¶">Spark å†…ç½® RPC æ¡†æ¶</h4>
<p>åœ¨ Spark ä¸­, å¾ˆå¤šåœ°æ–¹éƒ½æ¶‰åŠåˆ°ç½‘ç»œé€šè®¯, æ¯”å¦‚ Spark å„ä¸ªç»„ä»¶é—´çš„æ¶ˆæ¯äº’é€š, ç”¨æˆ·æ–‡ä»¶ä¸ Jar åŒ…çš„ä¸Šä¼ , èŠ‚ç‚¹é—´çš„ Shuffle è¿‡ç¨‹, Block æ•°æ®çš„å¤åˆ¶ä¸å¤‡ä»½ç­‰.</p>
<ol>
<li>åœ¨ Spark0.x.x ä¸ Spark1.x.x ç‰ˆæœ¬ä¸­, ç»„ä»¶é—´çš„æ¶ˆæ¯é€šä¿¡ä¸»è¦å€ŸåŠ©äº Akka.</li>
<li>åœ¨ Spark1.3 ä¸­å¼•å…¥äº† Netty é€šä¿¡æ¡†æ¶. Akkaè¦æ±‚messageå‘é€ç«¯å’Œæ¥æ”¶ç«¯æœ‰ç›¸åŒçš„ç‰ˆæœ¬, æ‰€ä»¥ä¸ºäº†é¿å… Akka é€ æˆçš„ç‰ˆæœ¬é—®é¢˜ï¼Œå¹¶ç»™ç”¨æˆ·çš„åº”ç”¨æ›´å¤§çµæ´»æ€§ï¼Œå†³å®šä½¿ç”¨æ›´é€šç”¨çš„ RPC å®ç°ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨çš„ Netty æ¥æ›¿ä»£ Akkaã€‚</li>
<li>Spark1.6 ä¸­ Akka å’Œ Netty å¯ä»¥é…ç½®ä½¿ç”¨ã€‚Netty å®Œå…¨å®ç°äº† Akka åœ¨Spark ä¸­çš„åŠŸèƒ½ã€‚</li>
<li>ä»Spark2.0.0, Akka è¢«ç§»é™¤.</li>
</ol>
<h4 id="actor-æ¨¡å‹">Actor æ¨¡å‹</h4>
<figure data-type="image" tabindex="1"><img src="https://liuwenlu12.github.io//post-images/1582730544913.png" alt=""></figure>
<h4 id="netty-é€šä¿¡æ¶æ„">Netty é€šä¿¡æ¶æ„</h4>
<p>Netty å€Ÿé‰´äº† Akka çš„ Actor æ¨¡å‹<br>
Sparké€šè®¯æ¡†æ¶ä¸­å„ä¸ªç»„ä»¶ï¼ˆClient/Master/Workerï¼‰å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªä¸ªç‹¬ç«‹çš„å®ä½“ï¼Œå„ä¸ªå®ä½“ä¹‹é—´é€šè¿‡æ¶ˆæ¯æ¥è¿›è¡Œé€šä¿¡ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://liuwenlu12.github.io//post-images/1582730593467.png" alt=""></figure>
<p>è¯¦ç»†<br>
<img src="https://liuwenlu12.github.io//post-images/1582730972828.png" alt=""></p>
<p>é«˜å±‚ä¿¯è§†å›¾<br>
<img src="https://liuwenlu12.github.io//post-images/1582731230217.png" alt=""></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Sparkå†…æ ¸]]></title>
        <id>https://liuwenlu12.github.io//post/spark-nei-he</id>
        <link href="https://liuwenlu12.github.io//post/spark-nei-he">
        </link>
        <updated>2020-02-26T14:43:04.000Z</updated>
        <content type="html"><![CDATA[<h3 id="sparkæ ¸å¿ƒç»„ä»¶">Sparkæ ¸å¿ƒç»„ä»¶</h3>
<ol>
<li>Cluster Manager (åˆ†é…çš„èµ„æºå±äºä¸€çº§åˆ†é…, å®ƒå°†å„ä¸ª Worker ä¸Šçš„å†…å­˜, CPU ç­‰èµ„æºåˆ†é…ç»™ Application, ä½†å¹¶ä¸è´Ÿè´£å¯¹ Executor çš„èµ„æºçš„åˆ†é…)
<ol>
<li>Master  (Standalone)</li>
<li>ResourceManager (Yarn)</li>
<li>MesosMaster (Mesos)</li>
<li>Kubernetes  2.3.0æ–°å¢ (dockeré…åˆ)</li>
</ol>
</li>
<li>Worker (å·¥ä½œèŠ‚ç‚¹ åœ¨ Yarn éƒ¨ç½²æ¨¡å¼ä¸‹å®é™…ç”± NodeManager æ›¿ä»£)
<ol>
<li>å°†è‡ªå·±çš„å†…å­˜, CPU ç­‰èµ„æºé€šè¿‡æ³¨å†Œæœºåˆ¶å‘ŠçŸ¥ Cluster Manager</li>
<li>åˆ›å»º Executorè¿›ç¨‹</li>
<li>å°†èµ„æºå’Œä»»åŠ¡è¿›ä¸€æ­¥åˆ†é…ç»™ Executor</li>
<li>åŒæ­¥èµ„æºä¿¡æ¯, Executor çŠ¶æ€ä¿¡æ¯ç»™ ClusterManager ç­‰.</li>
</ol>
</li>
<li>Driver (Spark é©±åŠ¨å™¨èŠ‚ç‚¹ï¼Œç”¨äºæ‰§è¡Œ Spark ä»»åŠ¡ä¸­çš„ main æ–¹æ³•ï¼Œè´Ÿè´£å®é™…ä»£ç çš„æ‰§è¡Œå·¥ä½œ)
<ol>
<li>å°†ç”¨æˆ·ç¨‹åºè½¬åŒ–ä¸ºä½œä¸šï¼ˆJobï¼‰ï¼›</li>
<li>åœ¨ Executor ä¹‹é—´è°ƒåº¦ä»»åŠ¡ï¼ˆTaskï¼‰ï¼›</li>
<li>è·Ÿè¸ª Executor çš„æ‰§è¡Œæƒ…å†µï¼›</li>
<li>é€šè¿‡ UI å±•ç¤ºæŸ¥è¯¢è¿è¡Œæƒ…å†µï¼›</li>
</ol>
</li>
<li>Executor (Spark Executor èŠ‚ç‚¹æ˜¯è´Ÿè´£åœ¨ Spark ä½œä¸šä¸­è¿è¡Œå…·ä½“ä»»åŠ¡ï¼Œä»»åŠ¡å½¼æ­¤ä¹‹é—´ç›¸äº’ç‹¬ç«‹)        Spark åº”ç”¨å¯åŠ¨æ—¶ï¼ŒExecutor èŠ‚ç‚¹è¢«åŒæ—¶å¯åŠ¨ï¼Œå¹¶ä¸”å§‹ç»ˆä¼´éšç€æ•´ä¸ª Spark åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸè€Œå­˜åœ¨ã€‚<br>
å¦‚æœæœ‰ Executor èŠ‚ç‚¹å‘ç”Ÿäº†æ•…éšœæˆ–å´©æºƒï¼ŒSpark åº”ç”¨ä¹Ÿå¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œä¼šå°†å‡ºé”™èŠ‚ç‚¹ä¸Šçš„ä»»åŠ¡è°ƒåº¦åˆ°å…¶ä»– Executor èŠ‚ç‚¹ä¸Šç»§ç»­è¿è¡Œã€‚<br>
Executor æœ‰ä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼š</li>
<li>è´Ÿè´£è¿è¡Œç»„æˆ Spark åº”ç”¨çš„ä»»åŠ¡ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™é©±åŠ¨å™¨ï¼ˆDriverï¼‰ï¼›</li>
<li>å®ƒä»¬é€šè¿‡è‡ªèº«çš„å—ç®¡ç†å™¨ï¼ˆBlock Managerï¼‰ä¸ºç”¨æˆ·ç¨‹åºä¸­è¦æ±‚ç¼“å­˜çš„ RDD æä¾›å†…å­˜å¼å­˜å‚¨ã€‚RDD çš„æ•°æ®æ˜¯ç›´æ¥ç¼“å­˜åœ¨ Executor è¿›ç¨‹å†…çš„ï¼Œå› æ­¤ä»»åŠ¡å¯ä»¥åœ¨è¿è¡Œæ—¶å……åˆ†åˆ©ç”¨ç¼“å­˜æ•°æ®åŠ é€Ÿè¿ç®—ã€‚</li>
<li>Application<br>
â€¢ Application é€šè¿‡ Spark API å°†è¿›è¡Œ RDD çš„è½¬æ¢å’Œ DAG çš„æ„å»º, å¹¶é€šè¿‡ Driver å°† Application æ³¨å†Œåˆ° Cluster Manager.<br>
â€¢	Cluster Manager å°†ä¼šæ ¹æ® Application çš„èµ„æºéœ€æ±‚, é€šè¿‡ä¸€çº§åˆ†é…å°† Executor, å†…å­˜, CPU ç­‰èµ„æºåˆ†é…ç»™ Application.<br>
â€¢	Driver é€šè¿‡äºŒçº§åˆ†é…å°† Executor ç­‰èµ„æºåˆ†é…ç»™æ¯ä¸€ä¸ªä»»åŠ¡, Application æœ€åé€šè¿‡ Driver å‘Šè¯‰ Executor è¿è¡Œä»»åŠ¡</li>
</ol>
<h5 id="4040ç«¯å£-driver">4040ç«¯å£-&gt;Driver</h5>
<h5 id="8080ç«¯å£-master">8080ç«¯å£-&gt;Master</h5>
<h5 id="8081ç«¯å£-worker">8081ç«¯å£-&gt;Worker</h5>
<h3 id="spark-é€šç”¨è¿è¡Œæµç¨‹æ¦‚è¿°">Spark é€šç”¨è¿è¡Œæµç¨‹æ¦‚è¿°</h3>
<figure data-type="image" tabindex="1"><img src="https://liuwenlu12.github.io//post-images/1582730179336.png" alt=""></figure>
<ol>
<li>ä»»åŠ¡æäº¤åï¼Œéƒ½ä¼šå…ˆå¯åŠ¨ Driver ç¨‹åºï¼›</li>
<li>éšå Driver å‘é›†ç¾¤ç®¡ç†å™¨æ³¨å†Œåº”ç”¨ç¨‹åºï¼›</li>
<li>ä¹‹åé›†ç¾¤ç®¡ç†å™¨æ ¹æ®æ­¤ä»»åŠ¡çš„é…ç½®æ–‡ä»¶åˆ†é… Executor å¹¶å¯åŠ¨è¯¥åº”ç”¨ç¨‹åºï¼›</li>
<li>å½“ Driver æ‰€éœ€çš„èµ„æºå…¨éƒ¨æ»¡è¶³åï¼ŒDriver å¼€å§‹æ‰§è¡Œ main å‡½æ•°ï¼ŒSpark è½¬æ¢ä¸ºæ‡’æ‰§è¡Œï¼Œå½“æ‰§è¡Œåˆ° Action ç®—å­æ—¶å¼€å§‹åå‘æ¨ç®—ï¼Œæ ¹æ®å®½ä¾èµ–è¿›è¡Œ Stage çš„åˆ’åˆ†ï¼Œéšåæ¯ä¸€ä¸ª Stage å¯¹åº”ä¸€ä¸ª Tasksetï¼ŒTaskset ä¸­æœ‰å¤šä¸ªTaskï¼›</li>
<li>æ ¹æ®æœ¬åœ°åŒ–åŸåˆ™ï¼ŒTask ä¼šè¢«åˆ†å‘åˆ°æŒ‡å®šçš„ Executor å»æ‰§è¡Œï¼Œåœ¨ä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒExecutor ä¹Ÿä¼šä¸æ–­ä¸ Driver è¿›è¡Œé€šä¿¡ï¼ŒæŠ¥å‘Šä»»åŠ¡è¿è¡Œæƒ…å†µã€‚</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[SparkStreamingå¤„ç†å®Œæ•°æ®å†™å…¥redis]]></title>
        <id>https://liuwenlu12.github.io//post/sparkstreaming-chu-li-wan-shu-ju-xie-ru-redis</id>
        <link href="https://liuwenlu12.github.io//post/sparkstreaming-chu-li-wan-shu-ju-xie-ru-redis">
        </link>
        <updated>2020-02-26T14:27:36.000Z</updated>
        <content type="html"><![CDATA[<h4 id="redisutil">RedisUtil</h4>
<pre><code>package com.atguigu.day02.project.util

import redis.clients.jedis.Jedis

object RedisUtil {
  /**
   * ä¸¤ç§æ–¹å¼ï¼š
   * 1.ä½¿ç”¨è¿æ¥æ± 
   * æ•ˆç‡æ›´é«˜ è¿æ¥ä¼šé‡ç”¨
   * å®é™…æƒ…å†µ å®¹æ˜“å‡ºç°å¤šçº¿ç¨‹bug
   * 2.æ‰‹åŠ¨åˆ›å»ºè¿æ¥çš„å®¢æˆ·ç«¯å¯¹è±¡
   * ç”¨å®ŒåŠ¡å¿…å…³é—­
   */
  val host = &quot;lwl007&quot;
  val port = 6379
    //è·å–å®¢æˆ·ç«¯å¯¹è±¡
  def getClient = new Jedis(host, port)
    //å…³é—­å®¢æˆ·ç«¯
  def close(client: Jedis): Unit = {
    if (client != null) client.close()
  }
}

</code></pre>
<h4 id="æ•°æ®å†™å…¥">æ•°æ®å†™å…¥</h4>
<pre><code>    import org.json4s.JsonDSL._ //scalaè‡ªå¸¦è½¬json
    import scala.collection.JavaConversions._ //scalaå’Œjavaé›†åˆäº’è½¬
    val key = &quot;last:hour:ads&quot;
    adsIdAndHmCountIt.foreachRDD(rdd =&gt; {
      rdd.foreachPartition((it: Iterator[(String, Iterable[(String, Int)])]) =&gt; {
        //å†™å…¥æ•°æ®
        if (it.hasNext) {
          //å»ºç«‹è¿æ¥
          val client: Jedis = RedisUtil.getClient
          val map: Map[String, String] = it.map {
            case (adsId, hmCountIt) =&gt; {
              //ä¸åŠ toMap [{},{}]  åŠ toMap{K1:V1,K2:V2}
              val hmCountItToMap: Map[String, Int] = hmCountIt.toMap
              (adsId, JsonMethods.compact(JsonMethods.render(hmCountItToMap)))
            }
          }.toMap
          client.hmset(key, map)
          RedisUtil.close(client)
        }
      })
    })
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è¿­ä»£å™¨]]></title>
        <id>https://liuwenlu12.github.io//post/die-dai-qi</id>
        <link href="https://liuwenlu12.github.io//post/die-dai-qi">
        </link>
        <updated>2020-02-26T14:13:40.000Z</updated>
        <content type="html"><![CDATA[<h4 id="ä»–ä»¬æ˜¯ä¸€ç§æƒ°æ€§æ•°æ®ç»“æ„å¹¶ä¸”ä»–ä»¬æ•°æ®åªèƒ½ä½¿ç”¨ä¸€æ¬¡">ä»–ä»¬æ˜¯ä¸€ç§æƒ°æ€§æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”ä»–ä»¬æ•°æ®åªèƒ½ä½¿ç”¨ä¸€æ¬¡</h4>
<pre><code> rdd.foreachPartition((it: Iterator[(String, Iterable[(String, Int)])]) =&gt;{
        //å»ºç«‹è¿æ¥
        val client: Jedis = RedisUtil.getClient
        //å†™å…¥æ•°æ®
        //Iterrator
        if(it.size&gt;0){
          println(it.toList)
        }
      })
</code></pre>
<h4 id="ç»“æœ">ç»“æœ</h4>
<pre><code>List()
List()
List()
List()
</code></pre>
<h4 id="è¿­ä»£å™¨ç‹¬æœ‰">è¿­ä»£å™¨ç‹¬æœ‰</h4>
<pre><code>  if(it.hasNext){  //it.next
          println(it.toList)
        }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://liuwenlu12.github.io//post/hello-gridea</id>
        <link href="https://liuwenlu12.github.io//post/hello-gridea">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>